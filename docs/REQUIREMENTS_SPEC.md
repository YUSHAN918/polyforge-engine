# PolyForge ä½“éªŒæ¨¡å¼ç›¸æœºç³»ç»Ÿé‡æ„ - å®Œæ•´éœ€æ±‚è§„æ ¼è¯´æ˜

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-12-30  
**ç›®æ ‡è¯»è€…**: AIé¦–å¸­æ¶æ„å¸ˆ  
**é¡¹ç›®ä»£å·**: Phase 17 å»¶ç»­ - ä½“éªŒæ¨¡å¼ç›¸æœºæ¶æ„é‡æ„

---

## ä¸€ã€èƒŒæ™¯ä¸å‰å› 

### 1.1 é¡¹ç›®ç°çŠ¶

**PolyForge v1.3.1** æ˜¯ä¸€ä¸ªåŸºäº **Entity-Component-System (ECS)** æ¶æ„çš„æ¸¸æˆå¼•æ“ï¼Œå½“å‰å¤„äº Phase 17 é˜¶æ®µã€‚

**å·²å®Œæˆå·¥ä½œ**ï¼ˆPhase 15 + 17ï¼‰ï¼š
- âœ… Phase 15.1-15.4: è§’è‰²ä¸ç›¸æœºæœºåˆ¶é‡æ„
  - ç›¸æœºä¸‰æ€é€»è¾‘ï¼ˆSpawn â†’ Unbind â†’ Bindï¼‰
  - WASDä¸‡èƒ½æ§åˆ¶
  - ä¸¥æ ¼ä¸Šå¸è§†è§’ï¼ˆISOç¦æ—‹è½¬ï¼‰
  - ç‰©ç†åŒæ­¥ä¿®å¤
- âœ… Phase 17: ä½“éªŒæ¨¡å¼äº¤äº’å®Œå–„
  - è¾“å…¥æ±¡æŸ“æ¸…ç†
  - é•œå¤´é«˜åº¦ç»Ÿä¸€
  - UIè‡ªåŠ¨åŒæ­¥ï¼ˆ500msè½®è¯¢ï¼‰
  - æ¨¡å—åˆ‡æ¢è‡ªåŠ¨é‡ç½®
  - çŠ¶æ€æŒä¹…åŒ–ä¿®å¤

**å½“å‰æˆæœ**ï¼š
- âœ… **ä¸Šå¸è§†è§’ (Isometric)**: å®Œç¾ - ç”Ÿæˆã€æ§åˆ¶ã€è·Ÿéšã€åˆ é™¤ã€é£è¡Œå…¨éƒ¨æ­£å¸¸
- âš ï¸ **ç¬¬ä¸€äººç§° (FPS)**: æœ‰æ¡ä»¶é™åˆ¶ - å¿…é¡»åœ¨å¹²å‡€çŠ¶æ€ä¸‹ç”Ÿæˆï¼Œè‹¥å…ˆåœ¨ISOç”Ÿæˆè¿‡è§’è‰²åˆ™æ— æ³•è·Ÿéš
- âŒ **ç¬¬ä¸‰äººç§° (TPS)**: æœªå®ç°
- âš ï¸ **æ¨ªæ¿å·è½´ (Sidescroll)**: è§’è‰²å¯æ§ä½†é•œå¤´ä¸è·Ÿéš

### 1.2 æ ¸å¿ƒé—®é¢˜

**ç°è±¡**ï¼š"ä¿®å¥½ä¸€ä¸ªï¼Œå¦ä¸€ä¸ªå°±å" - å…¸å‹çš„æ¶æ„æ€§é—®é¢˜

**æ ¹æœ¬ç—…å› **ï¼ˆç»æ·±åº¦åˆ†æï¼‰ï¼š
1. **åŒé‡ç»‘å®šæ··ä¹±** - `targetEntityId` vs `controlledEntityId` è¯­ä¹‰é‡å 
2. **æ¨¡å¼åˆ‡æ¢ç¼ºä¹æ¸…ç†** - Strategyçš„ `exit()` åªé‡ç½®å‚æ•°ï¼Œä¸æ¸…ç†ç»‘å®šå…³ç³»
3. **ç”Ÿå‘½å‘¨æœŸè„±èŠ‚** - è§’è‰²åˆ é™¤æ—¶éœ€æ‰‹åŠ¨æ¸…ç†ç›¸æœºç»‘å®š

**å½“å‰æ¶æ„é™åˆ¶**ï¼š
- æ— æ³•å®ç°"æœ‰è§’è‰²æƒ…å†µä¸‹æ— ç¼åˆ‡æ¢åˆ°å„ç§è§†è§’"
- æ·»åŠ æ–°è§†è§’éœ€è¦ä¿®æ”¹æ ¸å¿ƒé€»è¾‘
- çŠ¶æ€æ±¡æŸ“éš¾ä»¥æ ¹æ²»

---

## äºŒã€åˆ¶ä½œäººçš„æˆ˜ç•¥æ€è€ƒ

### 2.1 æ ¸å¿ƒè¯‰æ±‚

> **"æˆ‘æƒ³è¦çš„éªŒæ”¶æ•ˆæœæ˜¯ï¼šæœ‰ä¸ªå¯æ§åˆ¶çš„è§’è‰²ï¼Œç„¶åå¯ä»¥æ— ç¼æ¥å›åˆ‡æ¢åˆ°ä¸åŒçš„æ¸¸æˆè§†è§’ï¼ˆæš—é»‘/FPS/å¡å°”è¾¾/ç©ºæ´éª‘å£«ï¼‰ï¼Œå¹¶ä¸”è§’è‰²ä¿ç•™ç‰©ç†è½åœ°æ¨¡å¼å’Œé£è¡Œæ¨¡å¼ã€‚"**

**å…³é”®è¯**ï¼š
- **æ— ç¼åˆ‡æ¢** - æœ‰è§’è‰²æ—¶å¯è‡ªç”±åˆ‡æ¢è§†è§’
- **æ¸¸æˆåŒ–è§†è§’** - æ¯ç§è§†è§’å¯¹åº”ä¸€ç§æ¸¸æˆç±»å‹
- **æ‰©å±•æ€§** - åç»­èƒ½è½»æ¾æ·»åŠ DNFæ¸…ç‰ˆè§†è§’ç­‰æ–°æ¨¡å¼

### 2.2 æˆ˜ç•¥çº§é—®é¢˜

åˆ¶ä½œäººæå‡ºäº†ä¸‰ä¸ªæˆ˜ç•¥çº§æ·±åº¦é—®é¢˜ï¼š

**é—®é¢˜1: çŠ¶æ€éš”ç¦»**
> "æœ‰è§’è‰²æƒ…å†µå’Œæ— è§’è‰²æƒ…å†µéƒ½å¯ä»¥å®Œç¾ç›¸äº’ä¸å¹²æ¶‰ä¸å½±å“å¯¹å§ï¼Ÿä¸ä¼šç›¸äº’æ±¡æŸ“å§ï¼Ÿ"

**é—®é¢˜2: æœªæ¥AIç³»ç»Ÿ**
> "è§’è‰²è¦æœ‰å®Œæ•´çš„è¡Œä¸ºæ ‘ã€çŠ¶æ€æœºç­‰ï¼Œå°±æ˜¯å®Œæ•´çš„æ¸¸æˆåŒ–æœºåˆ¶ï¼Œèƒ½åŒ¹é…æˆ‘ä»¬çš„åº•å±‚æ¶æ„å—ï¼Ÿ"

**é—®é¢˜3: æ—§ç‰ˆèµ„äº§æ•´åˆ**
> "æ—§ç‰ˆæœ¬åšäº†ä¸€å †è‡ªå®šä¹‰ç¾æœ¯èµ„äº§çš„å·¥å…·ï¼ˆè§’è‰²ç¼–è¾‘å™¨/æ¨¡å‹å·¥ä½œåŠ/åŠ¨ä½œå·¥ä½œå®¤/VFXç¼–è¾‘å™¨ç­‰ï¼‰ï¼Œèƒ½å¦æ— ç¼å¯¹æ¥åˆ°å½±å­æ„å»ºä¸­ï¼Ÿ"

### 2.3 æ ¸å¿ƒä»·å€¼è§‚

**æ¸¸æˆåŒ–æ€ç»´ + ç›´è§‰å¼æ“ä½œ**ï¼š
- ç”¨æˆ·ä¸åº”è¯¥è®°ä½å¤æ‚çš„å‚æ•°ï¼ˆpitch/yaw/distanceï¼‰
- ä¸€é”®åˆ‡æ¢è§†è§’ï¼Œç³»ç»Ÿè‡ªåŠ¨å¤„ç†æ‰€æœ‰ç»†èŠ‚
- æ·»åŠ æ–°è§†è§’åº”è¯¥åƒ"æ’ä»¶"ä¸€æ ·ç®€å•

**æ¶æ„åŸåˆ™**ï¼š
- ç¬¦åˆ PolyForge çš„ ECS æ¶æ„é“å¾‹
- å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼ˆå¼€é—­åŸåˆ™ï¼‰
- å°æ­¥è¿­ä»£ï¼Œæ±‚ç¨³

---

## ä¸‰ã€æŠ€æœ¯åˆ†æ

### 3.1 ç°æœ‰æ¶æ„

**PolyForge æ ¸å¿ƒæ¶æ„**ï¼š
```
ECS æ ¸å¿ƒ
  â”œâ”€ Entity (å®ä½“)
  â”œâ”€ Component (ç»„ä»¶)
  â””â”€ System (ç³»ç»Ÿ)
       â””â”€ CameraSystem
            â”œâ”€ ICameraStrategy (æ¥å£)
            â”œâ”€ OrbitStrategy âœ… (å·²ç¨³å®š)
            â”œâ”€ IsometricStrategy âœ… (å·²ç¨³å®š)
            â”œâ”€ FirstPersonStrategy âš ï¸ (æœ‰é—®é¢˜)
            â”œâ”€ ThirdPersonStrategy âŒ (æœªå®ç°)
            â””â”€ SidescrollStrategy âš ï¸ (ä¸è·Ÿéš)
```

**æ¶æ„é“å¾‹**ï¼ˆæ¥è‡ª AGENT_CORE.mdï¼‰ï¼š
1. ECS çº¯å‡€æ€§ - æ ¸å¿ƒé€»è¾‘åœ¨ `src/core/systems`
2. æ•°æ®è¡¨ç°åˆ†ç¦» - æ¸²æŸ“åªæ˜¯çŠ¶æ€çš„"æŠ•å½±"
3. ç­–ç•¥æ¨¡å¼ - å·²è¯æ˜æœ‰æ•ˆï¼ˆOrbitStrategy ğŸ”’ FROZENï¼‰

**å·²æœ‰åŸºç¡€è®¾æ–½**ï¼š
- âœ… Strategy æ¨¡å¼ï¼ˆ6ä¸ªStrategyå®ç°ï¼‰
- âœ… CameraSnapshotï¼ˆé…ç½®å¿«ç…§ï¼‰
- âœ… å®Œæ•´çš„æ—§ç‰ˆè§’è‰²ç³»ç»Ÿï¼ˆRPGå±æ€§/æŠ€èƒ½/åŠ¨ç”»ï¼‰

### 3.2 è¡Œä¸šå¯¹æ ‡

**Unity Cinemachine**ï¼š
- è™šæ‹Ÿç›¸æœºæ ˆ + Brainè‡ªåŠ¨æ··åˆ
- Follow + LookAt åˆ†ç¦»
- ä¼˜å…ˆçº§è‡ªåŠ¨åˆ‡æ¢

**Unreal Camera Manager**ï¼š
- View Target + Camera Mode
- Blend ç®¡ç†å™¨
- Pawn ç”Ÿå‘½å‘¨æœŸè‡ªåŠ¨ç®¡ç†

**PolyForge éœ€è¦çš„æ˜¯**ï¼š
- è½»é‡çº§çš„è™šæ‹Ÿç›¸æœºæ¦‚å¿µï¼ˆPresetï¼‰
- ä¿æŒECSæ¶æ„çº¯å‡€
- å……åˆ†åˆ©ç”¨ç°æœ‰Strategyæ¨¡å¼

---

## å››ã€æ¨èæ–¹æ¡ˆï¼šCæ–¹æ¡ˆï¼ˆæ··åˆæ–¹æ¡ˆï¼‰

### 4.1 æ–¹æ¡ˆæ¦‚è¿°

**æ ¸å¿ƒæ€æƒ³**ï¼šå¼•å…¥ **CameraPreset** è½»é‡æ¦‚å¿µ + å¢å¼ºStrategyç‹¬ç«‹æ€§

**æ¶æ„è®¾è®¡**ï¼š
```typescript
// è½»é‡è™šæ‹Ÿç›¸æœº
interface CameraPreset {
  id: string;                 // 'iso', 'fps', 'tps', 'sidescroll', 'dnf'
  mode: CameraMode;           // å…³è”çš„ Strategy
  snapshot: CameraSnapshot;   // é»˜è®¤é…ç½®
  bindTarget: boolean;        // æ˜¯å¦éœ€è¦ç»‘å®šè§’è‰²
}

// Presetç®¡ç†å™¨
class CameraPresetManager {
  private presets: Map<string, CameraPreset>;
  
  registerPreset(preset: CameraPreset): void;  // åŠ¨æ€æ³¨å†Œï¼ˆæ”¯æŒMODï¼‰
  applyPreset(camera: CameraComponent, presetId: string): void;  // ä¸€é”®åˆ‡æ¢
}
```

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
1. âœ… **æ¶æ„åŒ¹é…** - å®Œç¾ç¬¦åˆECS + Strategyæ¨¡å¼
2. âœ… **æ— ç¼æ‰©å±•** - æ·»åŠ æ–°è§†è§’åªéœ€å†™Strategyï¼Œæ— éœ€æ”¹æ ¸å¿ƒ
3. âœ… **æ¸¸æˆåŒ–äº¤äº’** - ä¸€é”®åˆ‡æ¢ï¼Œç›´è§‰å¼æ“ä½œ
4. âœ… **MODæ”¯æŒ** - å¤©ç„¶æ”¯æŒç¬¬ä¸‰æ–¹ç›¸æœºè„šæœ¬

### 4.2 æ·»åŠ æ–°è§†è§’ç¤ºä¾‹ï¼ˆDNFæ¸…ç‰ˆï¼‰

```typescript
// 1. å†™ä¸€ä¸ªStrategyï¼ˆ50è¡Œä»£ç ï¼‰
class DnfBeatEmUpStrategy implements ICameraStrategy {
  public readonly name = 'dnfBeatEmUp';
  
  enter(camera: CameraComponent) {
    camera.pitch = 45;
    camera.yaw = 45;
    camera.distance = 15;
    camera.lockAxis = 'y';
  }
  
  exit(camera: CameraComponent) {
    camera.lockAxis = undefined;
  }
  
  handleInput(camera, inputSystem, deltaTime) {
    // åªå…è®¸å·¦å³æ—‹è½¬ï¼Œä¸å…è®¸ä¸Šä¸‹
  }
  
  updateTarget(camera, target, deltaTime) {
    // è·Ÿéšè§’è‰²ï¼Œå›ºå®šé«˜åº¦
  }
}

// 2. æ³¨å†ŒStrategyï¼ˆ1è¡Œï¼‰
cameraSystem.strategies.set('dnfBeatEmUp', new DnfBeatEmUpStrategy());

// 3. æ³¨å†ŒPresetï¼ˆé…ç½®ï¼‰
presetManager.registerPreset({
  id: 'dnf',
  mode: 'dnfBeatEmUp',
  bindTarget: true,
  snapshot: { pitch: 45, yaw: 45, distance: 15 }
});

// 4. å®Œæˆï¼UIè‡ªåŠ¨æ˜¾ç¤ºï¼Œä¸€é”®åˆ‡æ¢
```

### 4.3 ä¸‰å¤§æˆ˜ç•¥é—®é¢˜çš„è§£ç­”

**é—®é¢˜1: çŠ¶æ€éš”ç¦» âœ…**
- Presetçš„ `bindTarget` æ ‡å¿—æ˜ç¡®å£°æ˜æ˜¯å¦éœ€è¦è§’è‰²
- å¥åº·æ£€æŸ¥ï¼šåˆ‡æ¢æ—¶è‡ªåŠ¨éªŒè¯è§’è‰²å­˜åœ¨æ€§ï¼Œæ‹’ç»ä¸åˆæ³•åˆ‡æ¢
- è‡ªåŠ¨æ¸…ç†ï¼šè§’è‰²åˆ é™¤åè‡ªåŠ¨è§£ç»‘å¹¶åˆ‡å›æ— éœ€è§’è‰²çš„Preset
- **é›¶æ±¡æŸ“ä¿è¯**

**é—®é¢˜2: æœªæ¥AIç³»ç»Ÿ âœ…**
- æ—§ç‰ˆå·²æœ‰å®Œæ•´RPGç³»ç»Ÿï¼ˆå±æ€§/æŠ€èƒ½/ç¨‹åºåŒ–åŠ¨ç”»/å…³é”®å¸§åŠ¨ç”»ï¼‰
- AIç³»ç»Ÿé‡‡ç”¨æ ‡å‡†æ¶æ„ï¼šAIComponent + AISystem + è¡Œä¸ºæ ‘
- AIä¸ç›¸æœºå®Œå…¨è§£è€¦ï¼š`AI â†’ Physics â†’ Animation â†’ Camera`
- **å®Œç¾åŒ¹é…ECSæ¶æ„**

**é—®é¢˜3: æ—§ç‰ˆèµ„äº§æ•´åˆ âœ…**
- æ¨è **AssetBridge é€‚é…å™¨**æ–¹æ¡ˆ
- æ—§ç‰ˆå·¥å…·ä¿ç•™ï¼ˆEditorPanel/ModelWorkshop/ActionStudio/VfxEditorç­‰ï¼‰
- æ•°æ®è½¬æ¢ï¼š`CharacterConfig â†’ AssetBridge â†’ ECS Entity`
- **æ¸è¿›å¼è¿ç§»ï¼Œé›¶æµªè´¹**

---

## äº”ã€å®æ–½è®¡åˆ’ï¼ˆå°æ­¥è¿­ä»£ï¼‰

### é˜¶æ®µ1: Cæ–¹æ¡ˆæ ¸å¿ƒï¼ˆ10å°æ—¶ï¼‰â­â­â­â­â­

**ç›®æ ‡**ï¼šè§£å†³æ‰€æœ‰ç›¸æœºåˆ‡æ¢é—®é¢˜

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] 1.1 åˆ›å»º CameraPresetManagerï¼ˆ2hï¼‰
  - å®šä¹‰ CameraPreset æ¥å£
  - å®ç°æ³¨å†Œ/åº”ç”¨æ–¹æ³•
  - æ·»åŠ å¥åº·æ£€æŸ¥æœºåˆ¶
  
- [ ] 1.2 å¢å¼º CameraComponentï¼ˆ1hï¼‰
  - æ·»åŠ  `activePreset` å­—æ®µ
  - æ·»åŠ  `presetHistory` å­—æ®µ
  - æ›´æ–°åºåˆ—åŒ–é€»è¾‘
  
- [ ] 1.3 ç»Ÿä¸€ç»‘å®šé€»è¾‘ï¼ˆ2hï¼‰
  - ç§»é™¤ `controlledEntityId`
  - åªä¿ç•™ `targetEntityId`
  - æ·»åŠ ç›®æ ‡å­˜åœ¨æ€§æ£€æŸ¥
  - è‡ªåŠ¨æ¸…ç†æ— æ•ˆç»‘å®š
  
- [ ] 1.4 å¢å¼º Strategy æ¸…ç†ï¼ˆ2hï¼‰
  - é‡å†™æ‰€æœ‰ Strategy çš„ `exit()` æ–¹æ³•
  - ç¡®ä¿çŠ¶æ€å®Œå…¨é‡ç½®
  - ä¿ç•™å¿…è¦çš„ç»‘å®šå…³ç³»
  
- [ ] 1.5 å®šä¹‰5ä¸ªæ ‡å‡† Presetï¼ˆ2hï¼‰
  - `orbit` - åˆ›é€ æ¨¡å¼ï¼ˆOrbitï¼‰
  - `iso` - ä¸Šå¸è§†è§’ï¼ˆIsometricï¼‰
  - `fps` - ç¬¬ä¸€äººç§°ï¼ˆFirstPersonï¼‰
  - `tps` - ç¬¬ä¸‰äººç§°ï¼ˆThirdPersonï¼‰
  - `sidescroll` - æ¨ªæ¿å·è½´ï¼ˆSidescrollï¼‰
  
- [ ] 1.6 UIé›†æˆï¼ˆ1hï¼‰
  - æ›´æ–° ArchitectureValidationPanel
  - æ·»åŠ  Preset é€‰æ‹©å™¨
  - ç»‘å®š `applyPreset()` æ–¹æ³•

**éªŒæ”¶æ ‡å‡†**ï¼š
- âœ… ISO/FPS/TPS æ— ç¼åˆ‡æ¢
- âœ… æœ‰è§’è‰²/æ— è§’è‰²å®Œå…¨éš”ç¦»
- âœ… åˆ é™¤è§’è‰²è‡ªåŠ¨å›åˆ°åˆé€‚çš„Preset
- âœ… UIçŠ¶æ€100%åŒæ­¥

### é˜¶æ®µ2: Strategy å®Œå–„ï¼ˆ4å°æ—¶ï¼‰â­â­â­â­

**ç›®æ ‡**ï¼šå®ç°ä¸“ä¸šçº§é•œå¤´

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] 2.1 ä¿®å¤ FirstPersonStrategyï¼ˆ1.5hï¼‰
  - å®ç°å¤´éƒ¨ Socket é”å®š
  - å®ç°é¼ æ ‡ Look
  - æµ‹è¯•è§†è§’å¹³æ»‘åº¦
  
- [ ] 2.2 å®ç° ThirdPersonStrategyï¼ˆ2hï¼‰
  - å®ç°å¼¹ç°§è‡‚ï¼ˆSpring Armï¼‰
  - å®ç°ç¢°æ’æ£€æµ‹ï¼ˆé˜²ç©¿å¢™ï¼‰
  - å®ç°å¹³æ»‘è·Ÿéš
  
- [ ] 2.3 ä¿®å¤ SidescrollStrategyï¼ˆ0.5hï¼‰
  - å®ç°é•œå¤´è·Ÿéš
  - é”å®šZè½´

**éªŒæ”¶æ ‡å‡†**ï¼š
- âœ… æ‰€æœ‰æ¨¡å¼é•œå¤´è·Ÿéšæ­£å¸¸
- âœ… TPSé˜²ç©¿å¢™
- âœ… æ¨ªæ¿å·è½´å›ºå®šè§†è§’
- âœ… é•œå¤´å¹³æ»‘æ— æŠ–åŠ¨

### é˜¶æ®µ3: AssetBridgeï¼ˆ6å°æ—¶ï¼‰â­â­â­

**ç›®æ ‡**ï¼šæ—§ç‰ˆç¾æœ¯å·¥å…·å¤ç”¨

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] 3.1 åˆ›å»º AssetBridge ç±»ï¼ˆ2hï¼‰
  - CharacterConfig â†’ Entity è½¬æ¢å™¨
  - CustomModel åŠ è½½å™¨
  - Animation/VFX ç»‘å®šé€»è¾‘
  
- [ ] 3.2 EngineBridge é€‚é…ï¼ˆ2hï¼‰
  - æ£€æµ‹æ—§ç‰ˆæ•°æ®
  - æ¸²æŸ“ LegacyCharacter3D
  - ä¿æŒå‘åå…¼å®¹
  
- [ ] 3.3 æµ‹è¯•ä¸éªŒè¯ï¼ˆ2hï¼‰
  - å¯¼å…¥æ—§ç‰ˆè§’è‰²
  - éªŒè¯è‡ªå®šä¹‰æ­¦å™¨/è£…å¤‡æ˜¾ç¤º
  - éªŒè¯åŠ¨ä½œå’Œç‰¹æ•ˆæ’­æ”¾

**éªŒæ”¶æ ‡å‡†**ï¼š
- âœ… æ—§ç‰ˆè§’è‰²å¯å¯¼å…¥åˆ°ä½“éªŒæ¨¡å¼
- âœ… è‡ªå®šä¹‰æ­¦å™¨/è£…å¤‡æ­£å¸¸æ˜¾ç¤º
- âœ… åŠ¨ä½œå’Œç‰¹æ•ˆæ­£å¸¸æ’­æ”¾
- âœ… ä¸æ–°ç‰ˆECSç³»ç»Ÿå…±å­˜

### é˜¶æ®µ4: AI ç³»ç»Ÿï¼ˆåç»­è§„åˆ’ï¼‰â­â­

**ç›®æ ‡**ï¼šæ¸¸æˆåŒ–å®Œæ•´ä½“éªŒ

**ä»»åŠ¡æ¸…å•**ï¼ˆæ¦‚å¿µæ€§ï¼‰ï¼š
- [ ] 4.1 AIComponent è®¾è®¡
- [ ] 4.2 è¡Œä¸ºæ ‘å¼•æ“å®ç°
- [ ] 4.3 çŠ¶æ€æœºå®ç°
- [ ] 4.4 æ„ŸçŸ¥ç³»ç»Ÿ
- [ ] 4.5 å¯»è·¯ç³»ç»Ÿ

**è¯´æ˜**ï¼šæ­¤é˜¶æ®µåœ¨é˜¶æ®µ1-3å®Œæˆåå†è¿›è¡Œè¯¦ç»†è§„åˆ’

---

## å…­ã€æŠ€æœ¯è§„æ ¼

### 6.1 æ ¸å¿ƒæ¥å£

```typescript
// CameraPreset æ¥å£
interface CameraPreset {
  id: string;
  mode: CameraMode;
  snapshot: CameraSnapshot;
  bindTarget: boolean;
}

// CameraPresetManager API
class CameraPresetManager {
  registerPreset(preset: CameraPreset): void;
  applyPreset(camera: CameraComponent, presetId: string): boolean;
  getCurrentPreset(camera: CameraComponent): CameraPreset | null;
}

// AssetBridge API
class AssetBridge {
  createEntityFromCharacterConfig(
    config: CharacterConfig,
    entityManager: EntityManager
  ): string;
  
  loadCustomModels(gear: CharacterConfig['gear']): CustomModel[];
}
```

### 6.2 æ–‡ä»¶ä¿®æ”¹æ¸…å•

**æ–°å¢æ–‡ä»¶**ï¼š
- `src/core/systems/CameraPresetManager.ts`
- `src/core/AssetBridge.ts`

**ä¿®æ”¹æ–‡ä»¶**ï¼š
- `src/core/components/CameraComponent.ts`
- `src/core/systems/CameraSystem.ts`
- `src/core/systems/camera_strategies/*.ts` (æ‰€æœ‰Strategy)
- `src/core/ArchitectureValidationManager.ts`
- `src/components/rendering/ArchitectureValidationPanel.tsx`
- `src/components/rendering/EngineBridge.tsx`

### 6.3 å…¼å®¹æ€§ä¿è¯

- âœ… ä¿ç•™æ—§å­—æ®µä½œä¸º Deprecatedï¼ˆ`controlledEntityId`ï¼‰
- âœ… å‘åå…¼å®¹åºåˆ—åŒ–æ ¼å¼
- âœ… OrbitStrategy ğŸ”’ FROZEN ä¸ä¿®æ”¹

---

## ä¸ƒã€é£é™©è¯„ä¼°

| é£é™© | ç­‰çº§ | ç¼“è§£æªæ–½ |
|------|------|---------|
| ç ´åç°æœ‰åŠŸèƒ½ | ğŸŸ¡ ä¸­ | ä¿ç•™ OrbitStrategy ğŸ”’ FROZENï¼Œå…¶ä»–æ¸è¿›å¼ä¿®æ”¹ |
| æ€§èƒ½ä¸‹é™ | ğŸŸ¢ ä½ | Preset åªæ˜¯é…ç½®ï¼Œä¸å¢åŠ è¿è¡Œæ—¶å¼€é”€ |
| å…¼å®¹æ€§é—®é¢˜ | ğŸŸ¡ ä¸­ | ä¿ç•™æ—§å­—æ®µä½œä¸º Deprecatedï¼Œæ¸è¿›è¿ç§» |
| æµ‹è¯•è¦†ç›– | ğŸŸ¡ ä¸­ | æ¯ä¸ªé˜¶æ®µç‹¬ç«‹éªŒæ”¶ |

---

## å…«ã€æˆåŠŸæ ‡å‡†

### æœ€å°å¯è¡Œäº§å“ï¼ˆMVPï¼‰- é˜¶æ®µ1å®Œæˆ

**åŠŸèƒ½è¦æ±‚**ï¼š
- âœ… æœ‰è§’è‰²æ—¶å¯è‡ªç”±åˆ‡æ¢ ISO/FPS/TPS/Sidescroll
- âœ… æ— è§’è‰²æ—¶å¯ä½¿ç”¨ Orbit/ISO
- âœ… åˆ‡æ¢æ—¶çŠ¶æ€å®Œå…¨éš”ç¦»ï¼Œé›¶æ±¡æŸ“
- âœ… UI 100% åŒæ­¥

**æ€§èƒ½è¦æ±‚**ï¼š
- âœ… åˆ‡æ¢å»¶è¿Ÿ < 100ms
- âœ… FPS â‰¥ 60ï¼ˆ5000è‰ + è§’è‰²ï¼‰
- âœ… æ— å†…å­˜æ³„æ¼

**ç”¨æˆ·ä½“éªŒ**ï¼š
- âœ… ä¸€é”®åˆ‡æ¢ï¼Œæ— éœ€è®°ä½å‚æ•°
- âœ… åˆ é™¤è§’è‰²è‡ªåŠ¨å›é€€åˆ°åˆç†çŠ¶æ€
- âœ… é”™è¯¯æç¤ºå‹å¥½ï¼ˆå¦‚"éœ€è¦è§’è‰²"ï¼‰

### ç»ˆæç›®æ ‡ - é˜¶æ®µ3å®Œæˆ

- âœ… æ—§ç‰ˆç¾æœ¯å·¥å…·å®Œå…¨å¤ç”¨
- âœ… æ”¯æŒåŠ¨æ€æ·»åŠ æ–°è§†è§’ï¼ˆå¦‚DNFæ¸…ç‰ˆï¼‰
- âœ… ä¸ºæœªæ¥AIç³»ç»Ÿæ‰“å¥½åŸºç¡€

---

## ä¹ã€äº¤æ¥è¯´æ˜

### 9.1 å…³é”®æ–‡æ¡£

- **AGENT_CORE.md** - æ¶æ„é“å¾‹å’Œå†å²è¿›å±•
- **PROGRESS_SUMMARY.md** - æ€»è¿›åº¦æ¦‚è§ˆ
- **implementation_plan.md** - è¯¦ç»†æŠ€æœ¯æ–¹æ¡ˆ
- **docs/design.md** - æŠ€æœ¯è®¾è®¡æ€»çº²
- **docs/tasks/tasks_v1.3_final.md** - ä»»åŠ¡æ¸…å•

### 9.2 å…³é”®æ¦‚å¿µ

- **ECSæ¶æ„** - Entity-Component-System
- **Strategyæ¨¡å¼** - ç›¸æœºç­–ç•¥æ¨¡å¼
- **Presetæ¦‚å¿µ** - è½»é‡è™šæ‹Ÿç›¸æœº
- **AssetBridge** - æ—§ç‰ˆåˆ°æ–°ç‰ˆçš„æ¡¥æ¥å™¨
- **å½±å­æ„å»º** - src/core/ ç‹¬ç«‹äºæ—§ç‰ˆçš„æ–°æ¶æ„

### 9.3 å…³é”®çº¦æŸ

- âŒ **ç¦æ­¢ä¿®æ”¹** OrbitStrategyï¼ˆå·²æ ‡è®° ğŸ”’ FROZENï¼‰
- âœ… **å¿…é¡»ä¿æŒ** ECS çº¯å‡€æ€§
- âœ… **å¿…é¡»æ”¯æŒ** å°æ­¥è¿­ä»£éªŒæ”¶
- âœ… **å¿…é¡»è€ƒè™‘** æœªæ¥MODæ‰©å±•

---

## åã€é™„å½•

### A. æœ¯è¯­è¡¨

- **ISO** - Isometricï¼Œç­‰è·è§†è§’ï¼ˆç±»æš—é»‘ç ´åç¥ï¼‰
- **FPS** - First Person Shooterï¼Œç¬¬ä¸€äººç§°
- **TPS** - Third Person Shooterï¼Œç¬¬ä¸‰äººç§°ï¼ˆç±»å¡å°”è¾¾ï¼‰
- **Sidescroll** - æ¨ªç‰ˆå·è½´ï¼ˆç±»ç©ºæ´éª‘å£«ï¼‰
- **Preset** - ç›¸æœºé¢„è®¾ï¼Œè½»é‡è™šæ‹Ÿç›¸æœº
- **Strategy** - ç›¸æœºç­–ç•¥ï¼Œå®ç° ICameraStrategy æ¥å£
- **AssetBridge** - èµ„äº§æ¡¥æ¥å™¨ï¼Œæ—§ç‰ˆåˆ°æ–°ç‰ˆçš„é€‚é…å±‚

### B. å‚è€ƒèµ„æ–™

- Unity Cinemachine æ–‡æ¡£
- Unreal Engine Camera System æ–‡æ¡£
- PolyForge AGENT_CORE.md
- Phase 15-17 å®æ–½æŠ¥å‘Š

---

**æ–‡æ¡£ç»“æŸ**

**åˆ¶ä½œäººç­¾ç½²**: ___________  
**AIæ¶æ„å¸ˆç­¾ç½²**: ___________  
**æ—¥æœŸ**: 2025-12-30
