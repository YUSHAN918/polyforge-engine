# 🏔️ PolyForge 全息意志与技术主环白皮书 (VISION.md)

> **"愿景是代码的终极形态，而本协议是愿景的物理承载。"**
> 本文档是 PolyForge 项目的最高纲领。它拒绝一切形式的简化、摘要或信息的二次过滤。它通过对制作人（YUSHAN）愿景的深度挖掘及架构师（山神）的技术背书，确立了 PolyForge 的生命周期、资产主权与交互真谛。

---

## 🌟 第一部分：最高愿景与核心宗旨

### 1. 最高愿景 (Highest Vision)
**“让做游戏变得像玩游戏一样快乐！”**
PolyForge 不是为了增加开发者的负担，而是为了消除“技术门垒”带来的创作痛苦。我们的目标是构建一个让创作者能够在快乐的交互中，完成从灵感闪现到全球分发的闭环。

### 2. 核心交互设计宗旨 (Design Philosophy)
**“人类的直觉式交互” (Human Intuitive Interaction)**
- **超低门槛 (Zero-Friction Entry)**：创作应当是本能式的。即使是幼儿园的小朋友，在没有任何说明书的情况下，也应该能凭借物理直觉（如：拖动、堆叠、涂色）进行创作。操作逻辑必须符合物理常识与心理预期。
- **极高上限 (Industrial Strength Depth)**：简单并不代表简陋。在极简的外部 UI 下，我们必须保留对 ECS 底层最硬核的操控权力。专业人员可以通过配置、脚本或 AI 指令，实现深度的逻辑定制、粒子 Shader 编写以及大规模物理仿真。
- **AI 赋能 (Neural Creative Partner)**：AI 助手在 PolyForge 中不再只是一个“补全代码的插件”，它是“实时的创意合伙人”。它应能辅助资产生成、角色逻辑编排、甚至通过自然语言处理自动完成复杂的数值平衡性测试。

---

## 📝 第二部分：制作人开发愿景日志 (The Full Producer's Log)

### 1. 资产全维化与自给自足 (The Asset Sovereign)
PolyForge 必须能够独立生成游戏开发所需的一切资产，实现“闭环创作”：
- **模型资产**：从基础 LowPoly 到高面数精细模型。
- **动作资产**：涵盖人形、多足动物、机械运动。
- **特效资产 (VFX)**：从发光、碎裂到环境氛围。
- **环境道具**：水、植被、自然生态。
- **音乐与音效**：支持 BGM 创作与 3D 空间音效配置。
- **UI 界面**：支持游戏内 HUD 的自定义。
- **愿景实现**：用户在使用编辑器时，不需要频繁跳出编辑器去寻找外部素材，全都可以手动创作或由 AI 助手协助一气呵成。

### 2. 游戏玩法内核的集成与验证 (The Gameplay Nexus)
实现从“纯资产”到“强逻辑”的飞跃：
- **玩法构建案例 (MOBA 模式)**：
    *   **步骤 1**：快速搭建简易地图，布置双方泉水、防御塔。
    *   **步骤 2**：规划出兵道路与野区。
    *   **步骤 3**：从资产库调取角色，开始设计技能、配置数值与状态。
    *   **步骤 4**：在“沙包测试模式”下直接进行技能操作验证。
    *   **步骤 5**：配置小兵 AI 行为路径、出兵频率，实机开启同步演化。
- **战略要求**：通过可视化或配置化的方式，定义任何游戏类型（ARPG、FPS、TPS、MOBA、横板跳跃等）。

### 3. 配置化、数值与状态管理 (Attribute & Logic)
- **填鸭式逻辑部署**：模型创建完成后，进入“角色属性编辑器”，配置基础属性与成长数值；进入“动作实验室”，绑定自定义动画曲线；进入“技能实验室”，将动作与 VFX 特效组合，命名并存储至技能库。
- **方案动态切换**：支持在开发环境下随时切换多套已做好的技能包，进行对比测试。

### 4. 虚拟数值模型测试 (Numerical Sandbox & Flow Prediction)
避免设计初期的平衡性崩塌：
- **心流监控**：在测试模块下，通过点击模拟时长，切换时俗倍率（快进模拟），观察数值曲线。
- **效率要求**：在极短时间内（如 1 分钟）判断一个英雄在 30 分钟内的成长曲线是否平衡，判断塔防游戏的每一波数值是否符合玩家的心流波动。

### 5. 架构验证工具的深度运用 (The Architect's Valve)
- **模块联动监控**：实时观察各个功能模块（物理、逻辑、渲染、资产）是否正常同步。
- **指令化压力测试**：输入自然语言指令（如：“验证狼群与羊群在特定环境下的 30 分钟平衡性”），系统自动调配相关模块协同工作，找出数据互通中的 BUG 或性能瓶颈。

### 6. 专业级交互习惯 (UX Infrastructure)
- **操作一致性**：对齐 Blender/PS。支持自定义鼠标中键/右键的操作映射（旋转、平移、缩放）。
- **全局基准功能**：
    *   **统一撤回 (Global Undo/Redo)**：支持所有模块的撤销快捷键。
    *   **全局 ESC 功能**：统一的退出上一步、关闭菜单等交互响应。
    *   **低成本准则**：选取认知成本最低的操作方式，将常用功能前置到全局。

### 7. 外部资产上传与导入自适应 (The Bridge & Adaptation)
- **多格式支持**：预留上传本地原版资源（图标、音效、模型）的接口。
- **500W 面数高模处理方案**：
    *   允许导入在 Blender 中做好的高模步枪等资产。
    *   **核心逻辑**：引擎需具备“对标商业引擎”的处理能力。通过内置压缩算法或 LOD (多细节层次) 机制，确保高精度模型导入后不卡顿。
- **模型工坊双向互通**：
    *   **散包导出**：导出一堆由基础模型拼装的基础版本，方便在 Blender 等工具中进行零件级二次编辑。
    *   **封装导出**：一键封装定点的静物导出，便于直接分享、售卖与分享。
    *   **反向导入**：外部资产导入后，自适应底层技术栈，直接可编辑并使用。

### 8. 材质与高级表现 (Advanced Rendering)
- **霓虹与发光 (Glow)**：支持模型添加光剑、天使环等霓虹发光效果。
- **物理碎裂消失 (Dissolve & Fracture)**：敌人被击杀后，模拟物理特性碎成方块并慢慢消失。
- **特殊交互**：子弹时间、时间缩放等。
- **材质区分**：区分金属、木头、玻璃（半透明鱼缸内放灯泡等效果）。
- **画笔与涂鸦 (Doodle System)**：支持内置画笔、涂鸦喷枪在 30 表面进行纹身设计、发色渐变、墙面喷绘等二次设计。

### 9. 生物多样性与机械工程 (Biology & Machinery)
- **多足骨骼**：四足（马/羊）、多足（昆虫/蜘蛛）的运动控制与骨骼系统空间预留。
- **载具系统**：汽车、摩托、飞机、坦克等机械套件的系统空间预留。
- **物理环境逻辑**：斜坡、台阶、水体、动态植被的物理算法优化。

### 10. UGC 生态与分发主权 (UGC & Distribution)
- **联机愿景**：实现多人在线游玩、创建房间邀请好友共同游玩的功能。
- **单机独立分发**：支持将做好的游戏单品，通过 PolyForge 打包成可以在 Steam 等平台独立售卖的单机商品。
- **创作者版本**：每个玩家都能拥有编辑器，自由创作游戏并添加 MOD。

### 11. 律动动作与正向反馈机制 (Rhythm-Action & Positive Feedback)
- **动作音游混合 (Action-Rhythm Hybrid)**：打造类似《Hi-Fi RUSH》的极致节奏感，将 DNF 式的动作打击与节奏鼓点深度融合：
    *   **零负反馈原则 (Zero Penalty)**：不对错失节拍的行为进行物理惩罚，但为“全对”的高手提供极致的视觉特效 (VFX) 与数值奖励。
    *   **心流激发**：主打强节奏鼓点，让玩家在战斗中自然产生沉浸式心流。
- **AI 全息高光录制 (AI Highlights)**：利用 AI 技术自动检测玩家的“精彩瞬间”（如完美连招、极限反杀），自动完成捕捉、剪辑与视觉增强，实现一键社交分发。

### 12. 全息音乐编辑器与 UGC 闭环 (Music Editor & UGC Ecosystem)
- **内置音乐工作站 (In-Engine DAW)**：在引擎内建立原生的时钟同步音乐编辑器，支持：
    *   **节奏点编排 (Beat Mapping)**：资产产出即自带节奏信息，完美匹配游戏打击点。
    *   **资产流通**：支持音乐资产的上传、下载与社区交易，构建完整的音游/动作游戏生态闭环。

### 11. 2D 与 HD-2D 的降级兼容 (2D & HD-2D Universal Compatibility)
- **多维度降级 (Downsampling & Hybridity)**：PolyForge 虽然以 3D 架构立身，但必须向下完美兼容纯 2D 与 HD-2D（3D 环境+2D 资产）的游戏开发：
    *   **HD-2D 艺术复兴**：支持类似《歧路旅人》的风格（3D 场景 + 像素位图角色）或《饥荒》（3D 场景 + 立牌化 2D 资源）。
    *   **纯正 2D 体验**：通过平面图层管理与正交/锁定相机，模拟纯 2D 卡通或像素风游戏。
- **技术愿景**：PolyForge 要成为 2D 创作者转 3D 应用的最优解，让平面资产在 3D 空间中拥有超越维度的生命力。

---

## 🏔️ 第三部分：山神（架构师）的技术全景解析

### 1. ECS 架构：大厦的根基 (Iron Laws of ECS)
- **解析**：面对“全要素资产”与“海量数值模拟”，传统的 OOP (面向对象) 架构会因为层级过深而崩溃。ECS 将数据（组件）与逻辑（系统）彻底解耦，为“数值快进模拟”提供了 100 倍以上的计算冗余。
- **承诺**：永远保持逻辑的纯净。所有新功能（如：画笔、AI 行为树）必须以“组件”形式注入，严禁硬编码。

### 2. Standalone Bundle：数字生命的“胶囊” (PFB Architecture)
- **解析**：Phase 13 的 Bundle (PFB) 不再是单纯的存档。它是包含模型 UUID、二进制网格、材质贴图、动作序列以及**用户自定义涂鸦图层 (Doodle Buffer)** 的全息容器。
- **承诺**：PFB 协议将作为“独立分发”的核心。它不仅支持编辑器打开，更支持未来“Lite 版运行内核”的直接调用，从而支持 Steam 平台的运行。

### 3. 数值仿真沙盒的技术内核 (Headless Simulation)
- **解析**：为了实现在 1 分钟内模拟 30 分钟的“心流预判”，我们将利用 **Headless System Update**。
- **技术点**：断开渲染循环，开启逻辑最高频时钟，通过计算 `Component` 的状态漂移曲线，在 Canvas 上通过图表反馈给制作人。

### 4. 资产管道与高精度自适应 (Asset Pipeline & LOD)
- **解析**：500W 面数模型不卡顿的关键在于 **LOD (多细节层次)**。
- **技术路径**：
    *   导入阶段：`AssetRegistry` 调用后台优化算法，生成多个精度的代理 Mesh。
    *   运行阶段：`VisualSystem` 根据相机距离动态切换。
- **承诺**：我们在 Phase 13/20 阶段将锁定此流程，确保“资产导入即能玩”。

### 5. 动态材质与画笔涂鸦 (Dynamic Canvas Surface)
- **解析**：实现“模型画纹身”的关键在于 **Vertex Painting** 或 **Dynamic Texture Buffer**。
- **方案**：在 `VisualComponent` 中增加一个动态贴图槽位。画笔操作通过 Raycast 在 3D 表面修改纹理缓存，并随 Entity 一起序列化到 Bundle 中。

### 6. 交互驱动与全局配置 (Input Dispatcher)
- **解析**：实现 Blender 式操作需彻底解耦 `InputSystem`。
- **承诺**：建立 `InteractionConfig` 映射表。操作逻辑不写死在逻辑里，而是由配置表驱动，用户可随时在“设置面板”调换。

### 7. 空间影像分发与立牌架构 (Spatial Sprite & Standee)
- **解析**：实现 HD-2D 的关键不在于“增加 2D 引擎”，而在于“3D 引擎的颗粒化使用”。
- **方案**：
    *   **降维映射**：将 JPG/PNG 资产通过“幽灵放置系统”直接转化为 **立牌 (Standee)**、**贴纸 (Sticker)** 或 **告示板 (Billboard)**。
    *   **轴向锁定**：在 ECS 层面提供“面向相机锁定”组件，确保像素角色在 3D 旋转时始终保持最佳视口呈现。
- **承诺**：我们将在 Phase 13.x 中实装这套全息影像分发逻辑，它是通往“像素复古”与“高性能 2D”的物理大门。

### 8. 律动时钟与硬件级对齐 (Rhythm Clock & AudioWorklet)
- **解析**：音游的核心是“零误差”。JS 传统的 `setInterval` 无法满足高精度连招判定。
- **方案**：
    *   **AudioWorklet 驱动**：利用 Web Audio API 的底磁层 `AudioWorklet` 作为系统的主时钟源，将 ECS 系统逻辑频率与音频采样率进行物理对齐。
    *   **AI 识别算法**：开发轻量级的“精彩度评分模型”，实时监控 `ActionSystem` 的事件流，自动触发录制缓冲区的保留与合成。
- **承诺**：我们将在后续阶段为 `AudioSystem` 引入“节拍同步器”，作为音乐编辑器的原型。

---

## 📊 第四部分：核心玩法实现路径矩阵 (Possibilities)

| 玩法分类 | 适配精度 | 山神的技术底气与预案 |
| :--- | :--- | :--- |
| **ARPG (45°视角)** | 🌕🌕🌕🌕🌕 | **主场优势**。ECS 处理海量刷怪与掉落，Isometric 相机已🔒冻结。 |
| **HD-2D (歧路旅人风)** | 🌕🌕🌕🌕🌕 | **降维打击**。利用“影像三模态”系统实现 3D 深度与 2D 艺术的完美融合。 |
| **纯 2D (横板/跳跃)** | 🌕🌕🌕🌕🌑 | **空间图层**。锁定 Z 轴，利用平面网格模拟纯 2D 物理空间，需加强 2D 碰撞体。 |
| **横板动作 (DNF)** | 🌕🌕🌕🌕🌕 | **物理锁定**。锁定 Z 轴物理平移，打击感直接继承 Rapier 38 刚体反馈。 |
| **FPS/TPS** | 🌕🌕🌕🌕🌑 | **视角矩阵**。利用 CameraPreset 无缝切换。核心在于射击与受击反馈。 |
| **模拟/数值实验** | 🌕🌕🌕🌕🌕 | **仿真沙盒**。100x 倍速的无渲染数值演化验证，核心在于 LogicSystem。 |
| **塔防/消除/休闲** | 🌕🌕🌕🌕🌕 | **高度契合**。纯数据驱动，开发效率最高。 |
| **律动动作 (Rhythm-Act)** | 🌕🌕🌕🌕🌗 | **极高潜力**。核心在于 AudioWorklet 的时钟精度，是 PolyForge 的特色赛道。 |
| **音乐节奏 (音游)** | 🌕🌕🌕🌕🌕 | **绝对适配**。配合内置编辑器，可实现从创作到游玩的无缝衔接。 |
| **音乐节奏** | 🌕🌕🌕🌑🌑 | **硬件对齐**。需引入 AudioWorklet 以对齐硬件时钟，克服 JS 计时误差。 |

---

## 📅 第五部分：战略演进与阶段性共识

1. **协议层 (Foundation)**：Phase 13 RE (PFB v2) 是我们的生命线。它必须解决“全资产协议”和“外部导入接口预留”。
2. **交互层 (Interaction)**：Phase 19/20 重点解决全局 UX 标准、Blender 式自定义和多预设相机无缝切换。
3. **内容层 (Content)**：后续逐步引入资产工坊的“填鸭式”内容（四足生物、载具、AI 行为树编辑）。

---
**签署人**：制作人 (YUSHAN) & 山神 (Mountain God)
**最后更新**：2026-01-01 (v1.3.6)
**声明**：本文档为 PolyForge 最完整之意志档案，绝对禁止任何形式的简化或对愿景描述的删减。本文件应随项目仓库永久流转。
