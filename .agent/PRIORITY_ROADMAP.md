# 🎯 PolyForge 优先级路线图 (PRIORITY_ROADMAP.md)

**制定日期**: 2026-01-03  
**制定人**: 山神 (Mountain God) + 制作人 (YUSHAN)  
**状态**: ✅ 已确认

---

## 📊 优先级分级说明

| 优先级 | 时间范围 | 目标 | 特征 |
|---|---|---|---|
| **P0** | 1-2 周 | 紧急修复 | 阻塞现有功能使用 |
| **P1** | 1-2 月 | 核心功能补全 | 完善基础能力 |
| **P2** | 2-3 月 | 动画系统 | 内容创作核心 |
| **P3** | 2-3 月 | 视觉增强 | 提升表现力 |
| **P4** | 3-4 月 | 编辑器增强 | 提升生产力 |
| **P5** | 后期 | 生态整合 | 长期愿景 |

---

## 🔴 P0 - 紧急修复（1-2 周）

### Phase 23: 音频 UI 联通修复 ✅
**工作量**: 2-3 天  
**负责人**: 已完成  
**完成日期**: 2026-01-03

#### 核心问题
- ~~顶部 TEMPO 滑块 + 播放按钮未绑定到 AudioSystem~~
- ~~资产库音频缩略图无法预览播放~~

#### 任务清单
- [x] 修复顶部 TEMPO 滑块绑定
- [x] 修复播放按钮绑定
- [x] 实现资产库音频预览播放
- [x] 实现点击即听功能
- [x] 测试所有音频格式（MP3/WAV/OGG）

#### 验收标准
- ✅ 用户点击音频资产时，系统播放音频预览
- ✅ 用户调整 TEMPO 滑块时，系统实时调整播放速度
- ✅ 所有音频格式均可正常预览

#### 依赖
- Phase 9 AudioSystem（已完成）

**状态**: ✅ 已完成

---

## 🟡 P1 - 核心功能补全（1-2 月）

### Phase 24: 模型资产库 UI
**工作量**: 1-2 周  
**负责人**: 待分配  
**截止日期**: 2026-01-24

#### 核心问题
- 模型资产无分类导航
- 无网格预览功能
- 无拖拽放置功能

#### 任务清单
- [ ] 实现模型资产分类导航（按类型/标签）
- [ ] 实现网格预览功能（缩略图 + 3D 预览）
- [ ] 实现拖拽放置功能
- [ ] 实现资产搜索和过滤
- [ ] 实现资产元数据显示（顶点数/面数/骨骼数）

#### 验收标准
- ✅ 用户打开资产库时，系统显示所有已导入模型
- ✅ 用户拖拽模型时，系统在场景中放置模型
- ✅ 用户搜索模型时，系统实时过滤结果

#### 依赖
- Phase 7 AssetRegistry（已完成）

---

### Phase 25: LOD 自动生成
**工作量**: 1-2 周  
**负责人**: 待分配  
**截止日期**: 2026-02-07

#### 核心问题
- 高模导入后性能问题
- 无 LOD 自动生成
- 无相机距离动态切换

#### 任务清单
- [ ] 集成 meshoptimizer (WASM)
- [ ] 实现多级 LOD 自动生成（3 级）
- [ ] 实现相机距离动态切换
- [ ] 实现 LOD 配置 UI
- [ ] 实现 LOD 预览功能

#### 验收标准
- ✅ 用户导入高模时，系统自动生成 3 级 LOD
- ✅ 相机距离变化时，系统自动切换 LOD 级别
- ✅ 系统保持 60 FPS（即使场景中有大量高模）

#### 依赖
- Phase 7 ModelImporter（已完成）

---

## 🟠 P2 - 动画系统（2-3 月）

### Phase 26: 动画管线 (Animation Pipeline)
**工作量**: 2-3 周  
**负责人**: 待分配  
**截止日期**: 2026-03-07

#### 核心功能
- AnimationComponent - 动画数据组件
- AnimationSystem - 动画更新系统
- EngineBridge AnimationMixer 桥接
- UI 动画选择器
- 帧级事件系统
- 多生物骨骼支持（人形/四足/多足）
- 程序化动画 Additive Layer

#### 子任务
- [ ] 26.1 AnimationComponent（3 天）
- [ ] 26.2 AnimationSystem（5 天）
- [ ] 26.3 EngineBridge 桥接（3 天）
- [ ] 26.4 UI 动画选择器（2 天）
- [ ] 26.5 帧级事件系统（3 天）
- [ ] 26.6 多生物骨骼支持（5 天）
- [ ] 26.7 程序化动画 Additive Layer（3 天）

#### 验收标准
- ✅ 用户导入带动画的 GLB 时，系统自动提取所有动画
- ✅ 用户播放动画时，系统平滑播放并支持混合
- ✅ 动画播放到特定帧时，系统触发帧事件

#### 依赖
- Phase 7 ModelImporter（已完成）

---

### Phase 27: 2D 动画管线 (2D Animation)
**工作量**: 2-3 周  
**负责人**: 待分配  
**截止日期**: 2026-03-28

#### 核心功能
- SpriteSequenceComponent - 序列帧数据结构
- PNG 文件夹导入 + 自动打包
- Sprite Sheet 导入（指定行列）
- EngineBridge UV 偏移播放
- 资产库集成 + 拖拽预览
- Spine 资产导入（spine-threejs）
- 定格/流畅模式切换
- 骨骼动画 → 序列帧导出

#### 子任务
- [ ] 27.1 SpriteSequenceComponent（1 天）
- [ ] 27.2 PNG 文件夹导入（1-2 天）
- [ ] 27.3 Sprite Sheet 导入（1 天）
- [ ] 27.4 UV 偏移播放（1 天）
- [ ] 27.5 资产库集成（几小时）
- [ ] 27.6 Spine 资产导入（2-3 天）
- [ ] 27.7 定格/流畅模式（1 天）
- [ ] 27.8 骨骼动画导出（2 天）

#### 验收标准
- ✅ 用户导入 PNG 序列时，系统自动打包为 Sprite Sheet
- ✅ 用户导入 Spine 资产时，系统拖入即可播放
- ✅ 用户切换定格模式时，系统只在关键帧跳变

#### 依赖
- Phase 26 动画管线

---

### Phase 27.5: 节奏-事件管线 (Rhythm-Event)
**工作量**: 1-2 周  
**负责人**: 待分配  
**截止日期**: 2026-04-11

#### 核心功能
- 动画帧事件触发
- RhythmClock (AudioWorklet 高精度时钟)
- BeatMap 节拍图数据结构
- 节拍编辑器 UI

#### 验收标准
- ✅ 动画播放到特定帧时，系统触发事件
- ✅ 音乐播放到节拍点时，系统触发节拍事件
- ✅ 用户编辑节拍图时，系统可视化显示节拍点

#### 依赖
- Phase 26 动画管线
- Phase 9 AudioSystem（已完成）

---

### Phase 28: 碰撞体分层管线 (Collision Layers)
**工作量**: 1-2 周  
**负责人**: 待分配  
**截止日期**: 2026-04-25

#### 核心功能
- 攻击判定碰撞体（Box/Sphere）
- 骨骼绑定碰撞体
- 精确碰撞（Convex/Trimesh）
- 碰撞层级配置 UI

#### 验收标准
- ✅ 用户创建攻击判定时，系统绑定到骨骼
- ✅ 攻击判定碰撞时，系统触发伤害事件

#### 依赖
- Phase 26 动画管线

---

## 🟢 P3 - 视觉增强（2-3 月）

### Phase 29: VFX 特效管线 (VFX Pipeline)
**工作量**: 3-4 周  
**负责人**: 待分配  
**截止日期**: 2026-05-23

#### 核心功能
- ParticleEmitterComponent - 粒子发射器组件
- ParticleSystem - GPU Particles 系统
- ParticleMaterial - 粒子材质
- 2D 序列帧轨道（Billboard 渲染）
- VFX 编辑器 UI

#### 验收标准
- ✅ 用户创建粒子发射器时，系统使用 GPU Instancing 渲染
- ✅ 粒子数量超过 10000 时，系统保持 60 FPS

#### 依赖
- Phase 26 动画管线

---

### Phase 30: 大世界渲染管线 (Large World)
**工作量**: 3-4 周  
**负责人**: 待分配  
**截止日期**: 2026-06-20

#### 核心功能
- 大气散射 Shader（Rayleigh/Mie）
- 距离雾 + 天空渐变
- 地形 Chunk 分块（动态加载卸载）
- Billboard 远景优化
- 程序化生态分布

#### 验收标准
- ✅ 地图规模超过 1km 时，系统自动分块加载
- ✅ 相机移动时，系统动态加载/卸载 Chunk
- ✅ 远处物体时，系统使用 Billboard 渲染

#### 依赖
- Phase 11.2 TerrainSystem（已完成）

---

## 🔵 P4 - 编辑器增强（3-4 月）

### Phase 31: UI 编辑器管线 (UI Editor)
**工作量**: 4-6 周  
**负责人**: 待分配  
**截止日期**: 2026-08-15

#### 核心功能
- Dockable Layout MVP（2-3 周）
- Theme Engine（1-2 周）
- Schema-Driven Components（3-4 周）
- Visual UI Editor（4-6 周）
- Binding System（2-3 周）
- Game HUD Builder（4-6 周）

#### 验收标准
- ✅ 用户拖拽面板时，系统支持自由布局
- ✅ 用户创建 UI 组件时，系统自动绑定到 WorldState
- ✅ 用户切换主题时，系统实时更新所有 UI

#### 依赖
- 无

---

### Phase 32: 模型编辑管线 (Model Editing)
**工作量**: 3-4 周  
**负责人**: 待分配  
**截止日期**: 2026-09-12

#### 核心功能
- 布尔运算集成（three-bvh-csg）
- 合并选中物体 + 删内面
- 减面工具（SimplifyModifier）
- 一键封装导出 GLB
- 模型雕刻笔刷（基础）
- 补洞/修复工具

#### 验收标准
- ✅ 用户选中多个物体时，系统支持布尔运算（合并/相减）
- ✅ 用户导出模型时，系统自动减面并封装为 GLB

#### 依赖
- Phase 7 AssetRegistry（已完成）

---

## ⚪ P5 - 生态整合（后期）

### Phase 33: MOD 扩展系统
**工作量**: 2-3 周  
**负责人**: 待分配  
**截止日期**: TBD

#### 核心功能
- 动态组件注册
- 动态系统注册
- 热重载机制
- MOD 管理 UI

---

### Phase 34: React 19 + R3F 优化
**工作量**: 1-2 周  
**负责人**: 待分配  
**截止日期**: TBD

#### 核心功能
- React 19 升级
- R3F 性能优化
- 兼容性测试

---

### Phase 35: 旧版工坊打通（大和龙）
**工作量**: 4-6 周  
**负责人**: 待分配  
**截止日期**: TBD

#### 核心功能
- 英雄大厅桥接
- 装备库迁移
- 动画工坊桥接
- 程序化参数桥接
- 特效库评估

#### 依赖
- Phase 26-32 全部完成

---

### Phase 36: 导演/影视管线 (Director)
**工作量**: 3-4 周  
**负责人**: 待分配  
**截止日期**: TBD

#### 核心功能
- 时间轴编辑器
- 相机轨道动画
- AI 高光录制
- 视频导出

#### 依赖
- Phase 29 VFX
- Phase 31 UI Editor

---

## 📊 时间线总览

```
2026-01 | P0: Phase 23 (音频 UI)
        |
2026-02 | P1: Phase 24-25 (资产库 UI + LOD)
        |
2026-03 | P2: Phase 26-27 (动画管线 + 2D 动画)
        |
2026-04 | P2: Phase 27.5-28 (节奏事件 + 碰撞分层)
        |
2026-05 | P3: Phase 29 (VFX 特效)
        |
2026-06 | P3: Phase 30 (大世界渲染)
        |
2026-07 | P4: Phase 31 (UI 编辑器)
        |
2026-08 |
        |
2026-09 | P4: Phase 32 (模型编辑)
        |
2026-10+| P5: Phase 33-36 (生态整合)
```

---

## 🎯 关键里程碑

| 里程碑 | 日期 | 内容 |
|---|---|---|
| **M1: 基础修复完成** | 2026-01-10 | Phase 23 完成 |
| **M2: 核心功能补全** | 2026-02-07 | Phase 24-25 完成 |
| **M3: 动画系统上线** | 2026-04-25 | Phase 26-28 完成 |
| **M4: 视觉增强完成** | 2026-06-20 | Phase 29-30 完成 |
| **M5: 编辑器增强完成** | 2026-09-12 | Phase 31-32 完成 |
| **M6: 生态整合完成** | TBD | Phase 33-36 完成 |

---

## 📝 优先级调整机制

### 触发条件
- 用户反馈强烈需求
- 技术债务积累过多
- 外部依赖变化
- 竞品压力

### 调整流程
1. 制作人提出调整需求
2. 山神评估技术可行性
3. 双方确认新优先级
4. 更新本文档
5. 通知相关人员

---

**签署人**: 山神 (Mountain God) + 制作人 (YUSHAN)  
**制定日期**: 2026-01-03  
**下一次审查**: 2026-02-01
